{"version":3,"sources":["../../src/pages/chat/chat.module.ts","../../src/pages/chat/chat.ts"],"names":[],"mappings":"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","file":"35.main.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { Chat } from './chat';\n\n@NgModule({\n  declarations: [\n    Chat,\n  ],\n  imports: [\n    IonicPageModule.forChild(Chat),\n  ],\n  exports: [\n    Chat\n  ]\n})\nexport class ChatModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chat.module.ts","import { Component, ViewChild, ChangeDetectorRef } from '@angular/core';\nimport { IonicPage, NavController, NavParams } from 'ionic-angular';\nimport { Events, Content, TextInput } from 'ionic-angular';\nimport { JPushService } from '../../service/jPush.service';\nimport { UserService } from '../../service/user.service';\n\n/**\n * Generated class for the Chat page.\n *\n * See http://ionicframework.com/docs/components/#navigation for more info\n * on Ionic pages and navigation.\n */\ndeclare var window;\n@IonicPage()\n@Component({\n    selector: 'page-chat',\n    templateUrl: 'chat.html',\n})\nexport class Chat {\n\n    @ViewChild(Content) content: Content;\n    @ViewChild('chat_input') messageInput: TextInput;\n\n    msgList = [];\n    editorMsg = '';\n    toUserName = \"\";\n    targid;\n    targuserimg;\n    myuserimg;\n\n    constructor(\n        public navCtrl: NavController,\n        public navParams: NavParams,\n        public events: Events,\n        public ref: ChangeDetectorRef,\n        public JPushService: JPushService,\n        public UserService: UserService\n    ) {\n        this.targid = this.navParams.get('_id');\n        this.toUserName = this.navParams.get('name');\n        this.targuserimg = this.navParams.get('userimg');\n        this.myuserimg = this.UserService._user.userimg;\n        this.JPushService.inRoom = true;\n        this.JPushService.msgListTHIS = this;\n        //this.getAllMessages();\n    }\n\n\n    ionViewWillLeave() {\n        this.JPushService.inRoom = false;\n        this.JPushService.msgListTHIS = null;\n    }\n\n    sendMsg() {\n        if (this.editorMsg == '') {\n            return true;\n        }\n        var mjson = {\n            'name': this.UserService._user.name,\n            'userimg': this.myuserimg,\n            'toUserName': this.toUserName,\n            'targuserimg': this.targuserimg,\n            'cont': this.editorMsg,\n        };\n        //this.JPushService.JPIMsendSingleTextMessage(\"5919672950c7445c1d4b17de\",\"hello jp1\");\n        this.JPIMsendSingleCustomMessage(this.targid, JSON.stringify(mjson));\n        this.editorMsg = '';\n    }\n\n    JPIMsendSingleCustomMessage(username, JsonStr) {\n        var _that = this;\n        window.JMessage.sendSingleCustomMessage(username, JsonStr, null,\n            function (response) {\n                var message = JSON.parse(response);\n                //alert(response);\n                //_that.msgList.push(message);\n                _that.pushNewMsg(message);\n            }, function (errorMsg) {\n                alert(errorMsg);\t// 输出错误信息。\n            });\n    }\n\n    pushNewMsg(message) {\n        this.msgList.push(message);\n        //this.editorMsg = '';\n        this.scrollToBottom();\n\n    }\n\n    getAllMessages() {\n        var _that = this;\n        window.JMessage.getAllMessages('single', this.targid, null,\n            function (response) {\n                var messages = JSON.parse(response);\n                //alert(response);\n                //alert(messages[0]['direct']);\n                //alert(messages[0]['content']['contentStringMap']['cont']);\n                _that.msgList = messages;\n                _that.content.scrollToBottom();\n            }, function (errorMsg) {\n                console.log(errorMsg)\t// 输出错误信息。\n            })\n    }\n\n    scrollToBottom() {\n        if (this.content.scrollToBottom) {\n            this.content.scrollToBottom();\n        }\n        this.messageInput.setFocus();\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/chat/chat.ts"],"sourceRoot":""}